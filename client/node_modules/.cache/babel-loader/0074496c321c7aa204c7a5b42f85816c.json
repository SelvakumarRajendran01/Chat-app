{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{ThemeProvider}from\"@material-ui/core\";import{createMuiTheme,makeStyles}from\"@material-ui/core/styles\";import{useDispatch,useSelector}from\"react-redux\";import*as demoApi from\"../../api/demoAPI\";import{lightTheme,darkTheme}from\"../../utils/theme.js\";import SideBar from\"../../components/SideBar\";import ChatRoom from\"../../components/ChatRoom\";import{useHistory}from\"react-router-dom\";import NotificationContiner from\"../../components/Notification\";import Intro from\"../../components/Intro\";import socket from\"../../utils/socketUtils.js\";import{getUserDetail}from\"../../store/actions/userAction.js\";import{updateUserById}from\"../../api/usersApi.js\";import{setCurrentRoom}from\"../../store/actions/roomAction.js\";import{justJoinRoom}from\"../../utils/socketUtils.js\";import\"./style.css\";const Home=()=>{const currentTheme=useSelector(state=>state.system.currentTheme);const{email,id}=useSelector(state=>state.user);const{currentChatRoomId:currentChatRoom}=useSelector(state=>state.room);const history=useHistory();const dispatch=useDispatch();const{chatRooms,id:userId}=useSelector(state=>state.user);const joinAllSubscribedRooms=()=>{if(!chatRooms||chatRooms.length===0){return;}chatRooms.forEach(room=>{justJoinRoom(room._id);});};useEffect(()=>{dispatch(getUserDetail());dispatch(setCurrentRoom(-1));joinAllSubscribedRooms();updateUserById(userId,{socketId:socket.id});},[]);useEffect(()=>{socket.emit(\"set-socket-id\",{userId:id});},[]);if(!email){history.push(\"/signinsignup\");return/*#__PURE__*/React.createElement(React.Fragment,null);}const getTheme=()=>{switch(currentTheme){case\"light\":return lightTheme;case\"dark\":return darkTheme;}};const appliedTheme=createMuiTheme(getTheme());return/*#__PURE__*/React.createElement(ThemeProvider,{theme:appliedTheme},/*#__PURE__*/React.createElement(\"div\",{className:\"home\",style:{background:appliedTheme.palette.background.outerBackground,backgroundImage:appliedTheme.palette.background.outerBackgroundImage}},/*#__PURE__*/React.createElement(\"div\",{className:\"home__header\",style:{background:appliedTheme.palette.background.bannerBackground}}),/*#__PURE__*/React.createElement(\"div\",{className:\"home__body\",style:{background:appliedTheme.palette.background.innerBackground,boxShadow:appliedTheme.outerBoxShadow}},/*#__PURE__*/React.createElement(SideBar,null),/*#__PURE__*/React.createElement(ChatRoom,null),currentChatRoom===-1&&/*#__PURE__*/React.createElement(Intro,null),/*#__PURE__*/React.createElement(NotificationContiner,null))));};export default Home;","map":{"version":3,"names":["React","useState","useEffect","ThemeProvider","createMuiTheme","makeStyles","useDispatch","useSelector","demoApi","lightTheme","darkTheme","SideBar","ChatRoom","useHistory","NotificationContiner","Intro","socket","getUserDetail","updateUserById","setCurrentRoom","justJoinRoom","Home","currentTheme","state","system","email","id","user","currentChatRoomId","currentChatRoom","room","history","dispatch","chatRooms","userId","joinAllSubscribedRooms","length","forEach","_id","socketId","emit","push","createElement","Fragment","getTheme","appliedTheme","theme","className","style","background","palette","outerBackground","backgroundImage","outerBackgroundImage","bannerBackground","innerBackground","boxShadow","outerBoxShadow"],"sources":["/Users/mohanselva/Desktop/Private_Projects/Chat-app/client/src/containers/Home/index.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { ThemeProvider } from \"@material-ui/core\";\nimport { createMuiTheme, makeStyles } from \"@material-ui/core/styles\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as demoApi from \"../../api/demoAPI\";\nimport { lightTheme, darkTheme } from \"../../utils/theme.js\";\nimport SideBar from \"../../components/SideBar\";\nimport ChatRoom from \"../../components/ChatRoom\";\nimport {useHistory} from \"react-router-dom\";\nimport NotificationContiner from \"../../components/Notification\";\nimport Intro from \"../../components/Intro\";\nimport socket from \"../../utils/socketUtils.js\";\nimport {getUserDetail} from \"../../store/actions/userAction.js\";\nimport {updateUserById} from \"../../api/usersApi.js\";\nimport {setCurrentRoom} from \"../../store/actions/roomAction.js\";\nimport {justJoinRoom} from \"../../utils/socketUtils.js\";\n\nimport \"./style.css\";\n\nconst Home = () => {\n  const currentTheme = useSelector((state) => state.system.currentTheme);\n  const {email,id} = useSelector(state => state.user);\n  const {currentChatRoomId:currentChatRoom} = useSelector(state => state.room);\n  const history = useHistory();\n\n  const dispatch = useDispatch();\n  const {chatRooms, id:userId }= useSelector(state => state.user);\n\n  const joinAllSubscribedRooms = () => {\n    if(!chatRooms || chatRooms.length === 0)\n      {\n        return;\n      }\n      chatRooms.forEach(room => {\n        justJoinRoom(room._id);\n      });\n  }\n\n  useEffect(() => {\n    dispatch(getUserDetail());\n    dispatch(setCurrentRoom(-1));\n    joinAllSubscribedRooms();\n    updateUserById(userId, {socketId:socket.id});\n  },[]);\n\n\n  useEffect(() => {\n    socket.emit(\"set-socket-id\", {userId:id})\n  },[]);\n  \n  if(!email)\n    {\n      history.push(\"/signinsignup\");\n      return (<></>);\n    }\n\n  const getTheme = () => {\n    switch (currentTheme) {\n      case \"light\":\n        return lightTheme;\n      case \"dark\":\n        return darkTheme;\n    }\n  };\n\n  const appliedTheme = createMuiTheme(getTheme());\n\n  return (\n    <ThemeProvider theme={appliedTheme}>\n      <div\n        className=\"home\"\n        style={{ background: appliedTheme.palette.background.outerBackground, backgroundImage:appliedTheme.palette.background.outerBackgroundImage}}\n      >\n          <div className=\"home__header\" style={{background: appliedTheme.palette.background.bannerBackground}} />\n        <div\n          className=\"home__body\"\n          style={{\n            background: appliedTheme.palette.background.innerBackground,\n            boxShadow:appliedTheme.outerBoxShadow,\n          }}\n        >\n          <SideBar  />\n          <ChatRoom />\n          {currentChatRoom === -1 && <Intro />}\n          <NotificationContiner />\n        </div>\n      </div>\n    </ThemeProvider>\n  );\n};\n\nexport default Home;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,aAAa,KAAQ,mBAAmB,CACjD,OAASC,cAAc,CAAEC,UAAU,KAAQ,0BAA0B,CACrE,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,MAAO,GAAK,CAAAC,OAAO,KAAM,mBAAmB,CAC5C,OAASC,UAAU,CAAEC,SAAS,KAAQ,sBAAsB,CAC5D,MAAO,CAAAC,OAAO,KAAM,0BAA0B,CAC9C,MAAO,CAAAC,QAAQ,KAAM,2BAA2B,CAChD,OAAQC,UAAU,KAAO,kBAAkB,CAC3C,MAAO,CAAAC,oBAAoB,KAAM,+BAA+B,CAChE,MAAO,CAAAC,KAAK,KAAM,wBAAwB,CAC1C,MAAO,CAAAC,MAAM,KAAM,4BAA4B,CAC/C,OAAQC,aAAa,KAAO,mCAAmC,CAC/D,OAAQC,cAAc,KAAO,uBAAuB,CACpD,OAAQC,cAAc,KAAO,mCAAmC,CAChE,OAAQC,YAAY,KAAO,4BAA4B,CAEvD,MAAO,aAAa,CAEpB,KAAM,CAAAC,IAAI,CAAGA,CAAA,GAAM,CACjB,KAAM,CAAAC,YAAY,CAAGf,WAAW,CAAEgB,KAAK,EAAKA,KAAK,CAACC,MAAM,CAACF,YAAY,CAAC,CACtE,KAAM,CAACG,KAAK,CAACC,EAAE,CAAC,CAAGnB,WAAW,CAACgB,KAAK,EAAIA,KAAK,CAACI,IAAI,CAAC,CACnD,KAAM,CAACC,iBAAiB,CAACC,eAAe,CAAC,CAAGtB,WAAW,CAACgB,KAAK,EAAIA,KAAK,CAACO,IAAI,CAAC,CAC5E,KAAM,CAAAC,OAAO,CAAGlB,UAAU,CAAC,CAAC,CAE5B,KAAM,CAAAmB,QAAQ,CAAG1B,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAC2B,SAAS,CAAEP,EAAE,CAACQ,MAAO,CAAC,CAAE3B,WAAW,CAACgB,KAAK,EAAIA,KAAK,CAACI,IAAI,CAAC,CAE/D,KAAM,CAAAQ,sBAAsB,CAAGA,CAAA,GAAM,CACnC,GAAG,CAACF,SAAS,EAAIA,SAAS,CAACG,MAAM,GAAK,CAAC,CACrC,CACE,OACF,CACAH,SAAS,CAACI,OAAO,CAACP,IAAI,EAAI,CACxBV,YAAY,CAACU,IAAI,CAACQ,GAAG,CAAC,CACxB,CAAC,CAAC,CACN,CAAC,CAEDpC,SAAS,CAAC,IAAM,CACd8B,QAAQ,CAACf,aAAa,CAAC,CAAC,CAAC,CACzBe,QAAQ,CAACb,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAC5BgB,sBAAsB,CAAC,CAAC,CACxBjB,cAAc,CAACgB,MAAM,CAAE,CAACK,QAAQ,CAACvB,MAAM,CAACU,EAAE,CAAC,CAAC,CAC9C,CAAC,CAAC,EAAE,CAAC,CAGLxB,SAAS,CAAC,IAAM,CACdc,MAAM,CAACwB,IAAI,CAAC,eAAe,CAAE,CAACN,MAAM,CAACR,EAAE,CAAC,CAAC,CAC3C,CAAC,CAAC,EAAE,CAAC,CAEL,GAAG,CAACD,KAAK,CACP,CACEM,OAAO,CAACU,IAAI,CAAC,eAAe,CAAC,CAC7B,mBAAQzC,KAAA,CAAA0C,aAAA,CAAA1C,KAAA,CAAA2C,QAAA,KAAI,CAAC,CACf,CAEF,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,OAAQtB,YAAY,EAClB,IAAK,OAAO,CACV,MAAO,CAAAb,UAAU,CACnB,IAAK,MAAM,CACT,MAAO,CAAAC,SAAS,CACpB,CACF,CAAC,CAED,KAAM,CAAAmC,YAAY,CAAGzC,cAAc,CAACwC,QAAQ,CAAC,CAAC,CAAC,CAE/C,mBACE5C,KAAA,CAAA0C,aAAA,CAACvC,aAAa,EAAC2C,KAAK,CAAED,YAAa,eACjC7C,KAAA,CAAA0C,aAAA,QACEK,SAAS,CAAC,MAAM,CAChBC,KAAK,CAAE,CAAEC,UAAU,CAAEJ,YAAY,CAACK,OAAO,CAACD,UAAU,CAACE,eAAe,CAAEC,eAAe,CAACP,YAAY,CAACK,OAAO,CAACD,UAAU,CAACI,oBAAoB,CAAE,eAE1IrD,KAAA,CAAA0C,aAAA,QAAKK,SAAS,CAAC,cAAc,CAACC,KAAK,CAAE,CAACC,UAAU,CAAEJ,YAAY,CAACK,OAAO,CAACD,UAAU,CAACK,gBAAgB,CAAE,CAAE,CAAC,cACzGtD,KAAA,CAAA0C,aAAA,QACEK,SAAS,CAAC,YAAY,CACtBC,KAAK,CAAE,CACLC,UAAU,CAAEJ,YAAY,CAACK,OAAO,CAACD,UAAU,CAACM,eAAe,CAC3DC,SAAS,CAACX,YAAY,CAACY,cACzB,CAAE,eAEFzD,KAAA,CAAA0C,aAAA,CAAC/B,OAAO,KAAG,CAAC,cACZX,KAAA,CAAA0C,aAAA,CAAC9B,QAAQ,KAAE,CAAC,CACXiB,eAAe,GAAK,CAAC,CAAC,eAAI7B,KAAA,CAAA0C,aAAA,CAAC3B,KAAK,KAAE,CAAC,cACpCf,KAAA,CAAA0C,aAAA,CAAC5B,oBAAoB,KAAE,CACpB,CACF,CACQ,CAAC,CAEpB,CAAC,CAED,cAAe,CAAAO,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module"}