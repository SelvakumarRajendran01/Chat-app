{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Modal,Button,ListGroup}from\"react-bootstrap\";import{useTheme}from\"@material-ui/core\";import{Search as SearchIcon}from\"@material-ui/icons\";import{useDispatch,useSelector}from\"react-redux\";import{getUsersByName,addUserToRoom}from\"../../store/actions/userAction.js\";import ImageFromBuffer from\"../ImageFromBuffer\";import\"./style.scss\";import{createRoomAndJoinSocket}from\"../../utils/socketUtils.js\";import SearchBar from\"../SearchBar\";import{getUserIdByEmail}from\"../../api/usersApi.js\";import Swal from\"sweetalert2\";const AddUser=props=>{const[isSearchByName,setIsSearchByName]=useState(true);const[searchInput,setSearchInput]=useState(\"\");const[emailInput,setEmailInpuit]=useState('');const dispatch=useDispatch();const{searchedUsers,id:userId,friendList,email,isSearchingUsers}=useSelector(state=>state.user);const theme=useTheme();useEffect(()=>{dispatch(getUsersByName());},[]);const{background,text}=theme.palette;const setSearchByNameInput=value=>{setSearchInput(value);dispatch(getUsersByName(value));};const handleAddUserToRoom=(e,otherUserId)=>{createRoomAndJoinSocket(userId,otherUserId);};const findAndAddUserByEmail=async otherUserEmail=>{if(email===otherUserEmail){return;}try{const{userId:otherUserId}=await getUserIdByEmail(otherUserEmail);createRoomAndJoinSocket(userId,otherUserId);Swal.fire('Friend request sent.');}catch(err){Swal.fire(\"User not found.\");}};const searchByName=()=>{return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(SearchBar,{searchInput:searchInput,setSearchInput:setSearchByNameInput,placeHolder:\"Search for user by name\"}),isSearchingUsers?/*#__PURE__*/React.createElement(\"div\",{className:\"addUser__loader\",style:{borderTopColor:background.buttonBackground}}):/*#__PURE__*/React.createElement(React.Fragment,null),isSearchingUsers||/*#__PURE__*/React.createElement(ListGroup,null,Array.isArray(searchedUsers)&&searchedUsers.map(user=>{const otherUserId=user._id;if(userId===otherUserId){return/*#__PURE__*/React.createElement(React.Fragment,null);}return/*#__PURE__*/React.createElement(\"div\",{className:\"addUser__users-list\"},/*#__PURE__*/React.createElement(ImageFromBuffer,{arrayBuffer:user.profileImage.data.data,contentType:user.profileImage.contentType,className:\"addUser__users-list__img\"}),/*#__PURE__*/React.createElement(\"h5\",{className:\"addUser__users-list__name\"},user.displayName),/*#__PURE__*/React.createElement(Button,{className:\"addUser__users-list__button\",variant:friendList[otherUserId]?\"secondary\":\"success\",disabled:friendList[otherUserId],onClick:e=>handleAddUserToRoom(e,user._id)},friendList[otherUserId]?\"added\":\"add\"));})));};const addByEmail=()=>{return/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignContent:\"center\",justifyContent:\"flex-start\"}},/*#__PURE__*/React.createElement(SearchBar,{searchInput:emailInput,setSearchInput:setEmailInpuit,placeHolder:\"Add user by email\"}),/*#__PURE__*/React.createElement(Button,{onClick:e=>findAndAddUserByEmail(emailInput),style:{display:\"inline\"}},\"Add user by email\"));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true,className:\"addUser\"},/*#__PURE__*/React.createElement(Button,{className:\"mr-2\",onClick:e=>setIsSearchByName(true),variant:isSearchByName?\"primary\":\"secondary\"},\"Search By Name\"),/*#__PURE__*/React.createElement(Button,{variant:isSearchByName?\"secondary\":\"primary\",onClick:e=>setIsSearchByName(false)},\"Add By Email\")),/*#__PURE__*/React.createElement(Modal.Body,{style:{height:\"500px\",overflow:\"auto\",position:\"relative\"}},isSearchByName?searchByName():addByEmail()));};export default AddUser;","map":{"version":3,"names":["React","useState","useEffect","Modal","Button","ListGroup","useTheme","Search","SearchIcon","useDispatch","useSelector","getUsersByName","addUserToRoom","ImageFromBuffer","createRoomAndJoinSocket","SearchBar","getUserIdByEmail","Swal","AddUser","props","isSearchByName","setIsSearchByName","searchInput","setSearchInput","emailInput","setEmailInpuit","dispatch","searchedUsers","id","userId","friendList","email","isSearchingUsers","state","user","theme","background","text","palette","setSearchByNameInput","value","handleAddUserToRoom","e","otherUserId","findAndAddUserByEmail","otherUserEmail","fire","err","searchByName","createElement","Fragment","placeHolder","className","style","borderTopColor","buttonBackground","Array","isArray","map","_id","arrayBuffer","profileImage","data","contentType","displayName","variant","disabled","onClick","addByEmail","display","flexDirection","alignContent","justifyContent","Header","closeButton","Body","height","overflow","position"],"sources":["/Users/mohanselva/Desktop/Private_Projects/Chat-app/client/src/components/AddUser/index.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Modal, Button, ListGroup } from \"react-bootstrap\";\nimport { useTheme } from \"@material-ui/core\";\nimport { Search as SearchIcon } from \"@material-ui/icons\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  getUsersByName,\n  addUserToRoom,\n} from \"../../store/actions/userAction.js\";\nimport ImageFromBuffer from \"../ImageFromBuffer\";\nimport \"./style.scss\";\nimport { createRoomAndJoinSocket } from \"../../utils/socketUtils.js\";\nimport SearchBar from \"../SearchBar\";\nimport {getUserIdByEmail} from \"../../api/usersApi.js\";\nimport Swal from \"sweetalert2\";\n\nconst AddUser = (props) => {\n  const [isSearchByName, setIsSearchByName] = useState(true);\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [emailInput,setEmailInpuit] = useState('');\n  const dispatch = useDispatch();\n  const { searchedUsers, id: userId, friendList,email,isSearchingUsers } = useSelector(\n    (state) => state.user\n  );\n  const theme = useTheme();\n\n  useEffect(() => {\n    dispatch(getUsersByName());\n  }, []);\n\n  const { background, text } = theme.palette;\n\n  const setSearchByNameInput = (value) => {\n    setSearchInput(value);\n    dispatch(getUsersByName(value));\n  };\n\n  const handleAddUserToRoom = (e, otherUserId) => {\n    createRoomAndJoinSocket(userId, otherUserId);\n  };\n\n  const findAndAddUserByEmail = async (otherUserEmail) => {\n  if(email === otherUserEmail)\n    {\n      return;\n    }\n  try{\n    const {userId:otherUserId} = await getUserIdByEmail(otherUserEmail);\n    createRoomAndJoinSocket(userId,otherUserId);\n    Swal.fire('Friend request sent.')\n  }\n  catch(err)\n    {\n     Swal.fire(\"User not found.\");\n    }\n  }\n  const searchByName = () => {\n    return (\n      <>\n        <SearchBar\n          searchInput={searchInput}\n          setSearchInput={setSearchByNameInput}\n          placeHolder={\"Search for user by name\"}\n        />\n        {isSearchingUsers ?  <div className=\"addUser__loader\" style={{borderTopColor:background.buttonBackground}}/> : <></>}\n       {isSearchingUsers || <ListGroup>\n          {Array.isArray(searchedUsers) && searchedUsers.map((user) => {\n            const otherUserId = user._id;\n            if (userId === otherUserId) {\n              return <></>;\n            }\n            return (\n              <div className=\"addUser__users-list\">\n                <ImageFromBuffer\n                  arrayBuffer={user.profileImage.data.data}\n                  contentType={user.profileImage.contentType}\n                  className=\"addUser__users-list__img\"\n                />\n                <h5 className=\"addUser__users-list__name\">\n                  {user.displayName}\n                </h5>\n                <Button\n                  className=\"addUser__users-list__button\"\n                  variant={friendList[otherUserId] ? \"secondary\" : \"success\"}\n                  disabled={friendList[otherUserId]}\n                  onClick={(e) => handleAddUserToRoom(e, user._id)}\n                >\n                  {friendList[otherUserId] ? \"added\" : \"add\"}\n                </Button>\n              </div>\n            );\n          })}\n        </ListGroup>}\n      </>\n    );\n  };\n  const addByEmail = () => {\n    return (\n      <div style={{display:\"flex\", flexDirection:\"column\",alignContent:\"center\", justifyContent:\"flex-start\"}}>\n        <SearchBar searchInput={emailInput} setSearchInput={setEmailInpuit} placeHolder={\"Add user by email\"}/>\n        <Button onClick={e => findAndAddUserByEmail(emailInput)} style={{display:\"inline\"}} >Add user by email</Button>\n      </div>\n    );\n  };\n  return (\n    <>\n      <Modal.Header closeButton className=\"addUser\">\n        <Button className=\"mr-2\" onClick={(e) => setIsSearchByName(true)} variant={isSearchByName ? \"primary\" : \"secondary\"}>\n          Search By Name\n        </Button>\n        <Button variant={isSearchByName ?  \"secondary\" :  \"primary\"} onClick={(e) => setIsSearchByName(false)}>\n          Add By Email\n        </Button>\n      </Modal.Header>\n      <Modal.Body style={{ height: \"500px\", overflow: \"auto\",position:\"relative\" }}>\n        {isSearchByName ? searchByName() : addByEmail()}\n      </Modal.Body>\n    </>\n  );\n};\n\nexport default AddUser;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}